<div dir="auto">

# چرا تایپ اسکریپت؟
تایپ اسکریپت دو هدف اصلی رو دنبال می‌کند:
* ارائه‌ی *optional type system* برای جاوا اسکریپت.
* ارائه فیچرهایی که برای ورژن های آینده جاوااسکریپت قرار هست که ارائه بشه اما روی engine فعلی 

اما انگیزه پشت این دوهدف رو باید مورد بررسی قرار بدیم.

## The TypeScript type system

ممکن است برای شما این سوال پیش بیاید که "**چرا باید به جاوااسکریپت تایپ اضافه کرد؟**"

ثابت شده است که تایپ‌ها باعث افزایش کیفیت کد و خوانایی آن میشوند. تیم های بزرگ (مثل گوگل و مایکروسافت و فیس‌بوک) به طور مداوم به این نتیجه رسیده‌اند. مخصوصا:

* تایپ‌ها چابکی شما در هنگام ریفکتور را افزایش می‌دهند
*بهتر است که کامپایلر خطاها را تشخیص دهد (error catching)  تا اینکه در زمان اجرا (runtime)  چیزهایی خراب باشند (به نوعی باگ داشته باشند)*
* تایپ‌ها یکی از بهترین فرم‌ها برای مستند کردن آن چیزی است که شما در اختیار دارید.
 *اسم تابع مثل عنوان یک قضیه است و بدنه آن اثبات آن قضیه*

با این حال، اقزودن تایپ به کد جاوااسکریپت همیشه یک کار اضافه به نظر می‌آید. تایپ اسکریپت به صورت به خصوصی تلاش دارد که این کار اضاقه با کمترین مشکل انجام شود. اما چطور:

### کد جاوااسکریپت شما همین الان تایپ‌اسکریپت هم هست

تایپ‌اسکریپت صرفا در زمان اجرا یک  type safety به کد شما اضافه میکند. برای داشتن این type safety check شما کافیست که پسوند ‍`.js` در انتهای فایل خود را به `.ts` تغییر دهید و کامپایلر تایپ‌اسکریپت کماکان یک فایل `.js` معتبر که معادل فایل اصلی شما است، به شما تحویل می‌دهد. فراموش نکنیم که تایپ‌اسکریپت یک superset روی جاوااسکریپت است که یک optional type checking در اختیار شما می‌گذارد نه هیچ چیز دیگری.


### تایپ‌ها می‌توانند به صورت ضمنی تعریف شوند
تایپ‌اسکریپت همواره تلاش میکند تا جایی که میتواند اطلاعات مربوط به تایپ را استخراج کند تا به کمک آن بتواند type safety را با کمترین هزینه یا تاثیر بر بهره‌وری در زمان توسعه نرم‌افزار ارائه دهد. به طور مثال، در مثال زیر تایپ‌اسکریپت می‌داند که متغییر foo از نوع `number`  خواهد بود و برای خط دوم همان‌طور که می‌بینید خطا نشان خواهد داد:


```ts
var foo = 123;
foo = '456'; // Error: cannot assign `string` to `number`

// Is foo a number or a string?
```
اگر شما کارهایی از این دست که در مثال بالا نشان داده شد را انجام بدهید در بقیه کدها نمیتوانید مطمئن باشید که `foo` یک `number` است یا یک `string`. این‌گونه مشکلات معمولا در کدهایی رخ می‌دهد که از چندین فایل تشکیل شده‌اند. ما بعدا قوانین مربوط به استخراج تایپ(type inference) را به طور کامل مورد بررسی قرار می‌دهیم.

### تایپ‌ها می‌توانند به طور غیرضمنی تعریف شوند
همانطور که اشاره کردیم، تایپ اسکریپت به اندازه‌ای که type safety به خوبی کار کند، میتواند تایپ‌ها را به صورت خودکار تشخیص بدهد. با این‌حال شما می‌توانید از annotations استفاده کنید تا:

1. در کنار اینکه به کامپایلر کمک می‌کنید که تایپ ها را بهتر تشخیص بدهد، کدهای خود را برای دوولوپر بعدی (که ممکن است خود شما باشید) مستند می‌کنید.

2. annotation را اعمال می‌کنید تا کامپایلر همان‌چیزی را ببیند که شما فکر میکنید باید ببیند. این یعنی درک شما از کد با تحلیل الگوریتمی کد (انجام شده توسط کامپایلر) مطابقت دارد.

تایپ اسکریپت همانند دیگر زبانهایی که تعریف تایپ *optional* دارند(مثل actionScript و F#) از مدل postfix یا پسوندی استفاده می‌کند. یعنی بعد از تعریف متغییر تایپ آن را مشخص میکند.

```ts
var foo: number = 123; // foo value must be a number
```
حال اگر شما تغییر اشتباهی در مقدار متغییر انجام بدهید کامپایلر خطا گزراش خواهد کرد

```ts
var foo: number = '123'; // Error: cannot assign a `string` to a `number`
```
در فصل‌های بعدی در مورد تمام annotation هایی که تایپ‌اسکریپت پشتیبانی میکند با جزئیات صحبت خواهیم کرد

### تایپ‌ها ساختار دارند
در برخی زبان‌ها (مخصوصا آنهایی که تایپ دارند) افزودن تایپ‌های ایستا (static typing) یک تشریفات اضافه است چون با اینکه شما *شما می‌دانید* که کد شما درست کار میکند اما ساختار آن زبان شما را محبور می‌کند تا چیزهایی را کپی و تکرار کنید. به همین خاطر است که استفاده از مواردی مثل [automapper](https://automapper.org) برای c# ضروری است. در تایپ‌اسکریپت چون ما واقعا نیاز داریم که برای برنامه نویسان جاوااسکریپت ساده و با کمترین سربار باشد، تایپ‌ها ساختارمند شده اند. این بدان معناست که duck typing (به این معنی که تایپ یا کلاس یک آبجکت اهمیت کمتری نسبت به متدهای آن کلاس دارد) باعث ساخت یک first class language  می‌شود.

مثال زیر را در نظر بگیرید. فانکشن `iTakePoint2D` هر چیزی که شامل چیزهایی که `x` و ‍‍‍`y` قبول می‌کند را خواهد پذیرفت.

```ts
interface Point2D { 
    x: number;
    y: number;
}
interface Point3D {
    x: number;
    y: number;
    z: number;
}
var point2D: Point2D = { x: 0, y: 10 }
var point3D: Point3D = { x: 0, y: 10, z: 20 }
function iTakePoint2D(point: Point2D) { /* do something */ }

iTakePoint2D(point2D); // exact match okay
iTakePoint2D(point3D); // extra information okay
iTakePoint2D({ x: 0 }); // Error: missing information `y`
```

### خطاهای مربوط به تایپ‌ها جلوی کار جاوااسکریپت را نمی‌گیرد
برای اینکه کار مهاجرت از جاوااسکریپت به تایپ‌اسکریپت راحت باشد، با اینکه ممکن است خطاهای زمان کامپایل داشته باشید اما به صورت پیش فرض تایپ اسکریپت یک جاوااسکریپت معتبر منتشر خواهد کرد که باعث حلوگیری از روند اجرای جاوااسکریپت نمی شود.
یعنی حتی اگر type error  داشته باشیم باز کد ما کار خواهد کرد و صرفا در کد با خطاهایی روبه‌رو خواهیم شد. به طور مثال ثطعه کد زیر که دارای خطا می‌باشد

```ts
var foo = 123;
foo = '456'; // Error: cannot assign a `string` to a `number`
```

کد js زیر را تولید می‌کند که قابل اجرا است:

```ts
var foo = 123;
foo = '456';
```
بنابراین شما میتوانید به صورت افزایش کدهای جاوااسکریپت خود را به تایپ‌اسکریپت ارتفا بدهید بدون اینکه در اجرای کد شما ایرادی پیش بیاید. این رفتار کامپایلر تایپ‌اسکریپت با کامپایلر بسیاری از زبانهای دیگر متفاوت است و اتفاقا دلیل دیگری است برای اینکه به تایپ اسکریپت مهاجرت کنید.


### تایپ‌ها می‌توانند محیطی (‌ambient) باشند.
اینکه محیطی بودن به چه معناست ممکن است مقداری پیچیده باشد اما یکی از هدفهای طراحی تایپ اسکریپت این بود که استفاده از کتابخانه هایی که با جاوا اسکریپت نوشته شده‌اند در تایپ اسکریپت ساده و امن باشد. کتابخانه ای که با جاوااسکریپت نوشته شده است هیچ گونه تایپی ندارد اما تایپ اسکریپت با مفهوم *declaration* این کار را انجام می‌دهد. 
در تایپ‌اسکریپت هرچه زمان بیشتری صرف declaration کنید تایپ‌ها دقیق تر و کد شما هوشمند تر خواهد بود. به خاطر داشته باشید که بیشتر این تعریف ها برای کتابخانه‌های جاوااسکریپتی توسط [DefinitelyTyped community](https://github.com/borisyankov/DefinitelyTyped) نوشته شده است بنابراین برای بسیاری از موارد :

1. definition file وجود دارد
2. یا در بدترین حالت، شما یه لیست کامل از فایلهای definition  که به خوبی بررسی شده‌اند در  اختیار دارید

به عنوان یک مثال که شما چگونه میتونید یک فایل definition ایجاد کنید، می‌توانید یک قطعه کد کوچک jquery را در نظر بگیرید. به صورت پیش فرض تایپ‌اسکریپت توقع دارد که شما ثبل از استفاده از یک متغییر تایپ آن را declare کرده باشید
```ts
$('.awesome').show(); // Error: cannot find name `$`
```
یک راه‌حل سریع برای این مشکل این است که شما *به تایپ‌اسکریپت بگویید* که یک چیزی که `$` نامید ه می‌شود وجود دارد.
```ts
declare var $: any;
$('.awesome').show(); // Okay!
```
اگر بخواهید می‌توانید این definition را تکمیل تر کنید تا اطلاعات بیشتری را در اختیار کامپایلر و دوولوپر قرار دهد و البته از خطاهای بیشتر جلوگیری کند.

```ts
declare var $: {
    (selector:string): any;
};
$('.awesome').show(); // Okay!
$(123).show(); // Error: selector needs to be a string
```
زمانی‌که شما بیشتر با تایپ‌اسکریپت آشنا شدید (مثلا با `interface` یا `any`) با جزئیات بیشتری در مورد ساخت definition برای کدهای جاوااسکریپت صحبت خواهیم کرد.

## آینده جاوااسکریپت؟ چرا همین الان نه؟
تایپ‌اسکریپت تعدادی از فیچر‌هایی که قرار است در آینده به جاوااسکریپت اضافه شود را روی engine فعلی جاوااسکریپت ارائه می‌دهد. تیم تایپ‌اسکریپت به صورت مداوم مشغول اضافه کردن این فیچرهاست و لیست این فیچرها در مرور زمان در حال بزرگ و بزرگتر شدن است و این فیچر ها را در بخش خودش مورد بررسی قرار خواهیم داد. یک مثال صرفا جهت نمونه ای از این فیچرها اینجا ارائه می‌کنیم:

```ts
class Point {
    constructor(public x: number, public y: number) {
    }
    add(point: Point) {
        return new Point(this.x + point.x, this.y + point.y);
    }
}

var p1 = new Point(0, 10);
var p2 = new Point(10, 20);
var p3 = p1.add(p2); // { x: 10, y: 30 }
```

و همچنین arrow function عزیزمون:

```ts
var inc = x => x+1;
```

### خلاصه
در این بخش تلاش شد تا انگیزه و هدف از طراحی تایپ‌اسکریپت را بیان کنیم و الان می‌توانیم با این تعاریف وارد جزئیات بیشتری از تایپ‌اسکریپت شویم
</div>